<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #34495e; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .box { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 2; }
      .start { fill: #27ae60; stroke: #229954; }
      .process { fill: #3498db; stroke: #2980b9; }
      .decision { fill: #f39c12; stroke: #e67e22; }
      .end { fill: #e74c3c; stroke: #c0392b; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .dashed-arrow { stroke: #2c3e50; stroke-width: 2; fill: none; stroke-dasharray: 5,5; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="title">Flux Utilisateur - Application Parle</text>
  
  <!-- Start -->
  <ellipse cx="100" cy="80" rx="60" ry="30" class="start"/>
  <text x="100" y="85" text-anchor="middle" class="text">Début</text>
  
  <!-- Upload Image -->
  <rect x="50" y="150" width="100" height="60" class="process" rx="10"/>
  <text x="100" y="175" text-anchor="middle" class="text">Upload Image</text>
  <text x="100" y="190" text-anchor="middle" class="text">Scanner Page</text>
  
  <!-- OCR Processing -->
  <rect x="50" y="250" width="100" height="60" class="process" rx="10"/>
  <text x="100" y="275" text-anchor="middle" class="text">OCR Processing</text>
  <text x="100" y="290" text-anchor="middle" class="text">Tesseract</text>
  
  <!-- Display Text -->
  <rect x="50" y="350" width="100" height="60" class="process" rx="10"/>
  <text x="100" y="375" text-anchor="middle" class="text">Affichage Texte</text>
  <text x="100" y="390" text-anchor="middle" class="text">Paragraphes</text>
  
  <!-- Reading Loop Start -->
  <rect x="250" y="350" width="120" height="60" class="process" rx="10"/>
  <text x="310" y="375" text-anchor="middle" class="text">Lecture à voix haute</text>
  <text x="310" y="390" text-anchor="middle" class="text">Enregistrement Audio</text>
  
  <!-- Speech Analysis -->
  <rect x="250" y="450" width="120" height="60" class="process" rx="10"/>
  <text x="310" y="475" text-anchor="middle" class="text">Analyse Vocale</text>
  <text x="310" y="490" text-anchor="middle" class="text">Whisper + Alignement</text>
  
  <!-- Error Detection -->
  <rect x="250" y="550" width="120" height="60" class="process" rx="10"/>
  <text x="310" y="575" text-anchor="middle" class="text">Détection Erreurs</text>
  <text x="310" y="590" text-anchor="middle" class="text">Prononciation, Rythme</text>
  
  <!-- Decision: Errors? -->
  <polygon points="310,650 370,680 310,710 250,680" class="decision"/>
  <text x="310" y="685" text-anchor="middle" class="text">Erreurs</text>
  <text x="310" y="700" text-anchor="middle" class="text">détectées?</text>
  
  <!-- Feedback Display -->
  <rect x="450" y="650" width="120" height="60" class="process" rx="10"/>
  <text x="510" y="675" text-anchor="middle" class="text">Affichage Feedback</text>
  <text x="510" y="690" text-anchor="middle" class="text">Mots surlignés</text>
  
  <!-- Model Audio -->
  <rect x="450" y="750" width="120" height="60" class="process" rx="10"/>
  <text x="510" y="775" text-anchor="middle" class="text">Lecture Modèle</text>
  <text x="510" y="790" text-anchor="middle" class="text">gTTS/Coqui</text>
  
  <!-- Retry Reading -->
  <rect x="450" y="850" width="120" height="60" class="process" rx="10"/>
  <text x="510" y="875" text-anchor="middle" class="text">Nouvelle Lecture</text>
  <text x="510" y="890" text-anchor="middle" class="text">Correction</text>
  
  <!-- Paragraph Counter -->
  <rect x="650" y="350" width="120" height="60" class="process" rx="10"/>
  <text x="710" y="375" text-anchor="middle" class="text">Compteur</text>
  <text x="710" y="390" text-anchor="middle" class="text">Paragraphes</text>
  
  <!-- Decision: 2 paragraphs? -->
  <polygon points="710,450 770,480 710,510 650,480" class="decision"/>
  <text x="710" y="485" text-anchor="middle" class="text">2 paragraphes</text>
  <text x="710" y="500" text-anchor="middle" class="text">lus?</text>
  
  <!-- Summary Mode -->
  <rect x="850" y="450" width="120" height="60" class="process" rx="10"/>
  <text x="910" y="475" text-anchor="middle" class="text">Mode Résumé</text>
  <text x="910" y="490" text-anchor="middle" class="text">Enregistrement Oral</text>
  
  <!-- Summary Analysis -->
  <rect x="850" y="550" width="120" height="60" class="process" rx="10"/>
  <text x="910" y="575" text-anchor="middle" class="text">Analyse Résumé</text>
  <text x="910" y="590" text-anchor="middle" class="text">LLaMA/GPT</text>
  
  <!-- Summary Feedback -->
  <rect x="850" y="650" width="120" height="60" class="process" rx="10"/>
  <text x="910" y="675" text-anchor="middle" class="text">Feedback Résumé</text>
  <text x="910" y="690" text-anchor="middle" class="text">Suggestions</text>
  
  <!-- Progress Update -->
  <rect x="1050" y="450" width="120" height="60" class="process" rx="10"/>
  <text x="1110" y="475" text-anchor="middle" class="text">Mise à jour</text>
  <text x="1110" y="490" text-anchor="middle" class="text">Progression</text>
  
  <!-- Decision: More text? -->
  <polygon points="1110,550 1170,580 1110,610 1050,580" class="decision"/>
  <text x="1110" y="585" text-anchor="middle" class="text">Plus de</text>
  <text x="1110" y="600" text-anchor="middle" class="text">texte?</text>
  
  <!-- End -->
  <ellipse cx="1110" cy="700" rx="60" ry="30" class="end"/>
  <text x="1110" y="705" text-anchor="middle" class="text">Fin</text>
  
  <!-- Arrows -->
  <line x1="100" y1="110" x2="100" y2="150" class="arrow"/>
  <line x1="100" y1="210" x2="100" y2="250" class="arrow"/>
  <line x1="100" y1="310" x2="100" y2="350" class="arrow"/>
  <line x1="150" y1="380" x2="250" y2="380" class="arrow"/>
  <line x1="310" y1="410" x2="310" y2="450" class="arrow"/>
  <line x1="310" y1="510" x2="310" y2="550" class="arrow"/>
  <line x1="310" y1="610" x2="310" y2="650" class="arrow"/>
  <line x1="370" y1="680" x2="450" y2="680" class="arrow"/>
  <line x1="510" y1="710" x2="510" y2="750" class="arrow"/>
  <line x1="510" y1="810" x2="510" y2="850" class="arrow"/>
  <line x1="450" y1="880" x2="370" y2="880" class="dashed-arrow"/>
  <line x1="250" y1="880" x2="250" y2="650" class="dashed-arrow"/>
  <line x1="250" y1="650" x2="250" y2="550" class="dashed-arrow"/>
  <line x1="250" y1="550" x2="250" y2="450" class="dashed-arrow"/>
  <line x1="250" y1="450" x2="250" y2="410" class="dashed-arrow"/>
  <line x1="370" y1="380" x2="650" y2="380" class="arrow"/>
  <line x1="710" y1="410" x2="710" y2="450" class="arrow"/>
  <line x1="770" y1="480" x2="850" y2="480" class="arrow"/>
  <line x1="910" y1="510" x2="910" y2="550" class="arrow"/>
  <line x1="910" y1="610" x2="910" y2="650" class="arrow"/>
  <line x1="970" y1="680" x2="1050" y2="680" class="arrow"/>
  <line x1="1110" y1="510" x2="1110" y2="550" class="arrow"/>
  <line x1="1170" y1="580" x2="1170" y2="700" class="arrow"/>
  <line x1="1110" y1="700" x2="1110" y2="700" class="arrow"/>
  <line x1="1050" y1="700" x2="1110" y2="700" class="dashed-arrow"/>
  <line x1="1050" y1="700" x2="1050" y2="480" class="dashed-arrow"/>
  <line x1="1050" y1="480" x2="650" y2="480" class="dashed-arrow"/>
  <line x1="650" y1="480" x2="650" y2="410" class="dashed-arrow"/>
  
  <!-- Labels -->
  <text x="200" y="375" class="text">Oui</text>
  <text x="200" y="675" class="text">Oui</text>
  <text x="200" y="885" class="text">Répéter</text>
  <text x="200" y="485" class="text">Non</text>
  <text x="200" y="585" class="text">Non</text>
  <text x="200" y="785" class="text">Non</text>
  <text x="200" y="985" class="text">Non</text>
  <text x="200" y="1085" class="text">Oui</text>
  
  <!-- Legend -->
  <rect x="50" y="800" width="300" height="150" class="box" rx="10"/>
  <text x="200" y="825" text-anchor="middle" class="subtitle">Légende des Éléments</text>
  
  <ellipse cx="80" cy="850" rx="20" ry="10" class="start"/>
  <text x="110" y="855" class="text">Début/Fin</text>
  
  <rect x="70" y="870" width="40" height="20" class="process" rx="5"/>
  <text x="120" y="885" class="text">Processus</text>
  
  <polygon points="80,900 100,910 80,920 60,910" class="decision"/>
  <text x="110" y="915" class="text">Décision</text>
  
  <line x1="70" y1="930" x2="100" y2="930" class="arrow"/>
  <text x="110" y="935" class="text">Flux principal</text>
  
  <line x1="70" y1="940" x2="100" y2="940" class="dashed-arrow"/>
  <text x="110" y="945" class="text">Retour/Itération</text>
</svg>
